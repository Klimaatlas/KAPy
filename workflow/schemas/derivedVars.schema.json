{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "title": "KAPy derived variables configuration",
    "description": "Configuration of derived variables is set through a tab-separated table, with one row per variable. Note that the same schema is used for secondary and tertiary varibles - the main difference is the order in which they processed (primary > secondary > bias-adjustment > tertiary). Note that new variables declared here can refer to other derived variables, as long as they have already been declared higher up in the configuration table. All options are required.",
    "type": "object",
    "required": [
        "id",
        "processorType",
        "processorPath",
        "processorFunction",
        "passXarrays",
        "additionalArgs"
    ],
    "additionalProperties": false,
    "properties": {
        "id": {
            "description": "Code by which to refer to the variable e.g. `tas`, `SPI`, `pr` etc",
            "type": "string",
            "uniqueItems": true
        },
        "inputVars": {
            "description": "Comma-separated list of input variables to be used in generating this new variable.",
            "type": "array"
        },
        "outputVars": {
            "description": "Comma-separated list of output variables generated by the script. Some functions generate more than one variable at a time e.g. FWI and this is where they should be listed. Currently limited to one but will be extended in the future - issue #92 https://github.com/Klimaatlas/KAPy/issues/92.",
            "type": "array",
            "minItems": 1,
            "maxItems": 1
        },
        "processorType": {
            "description": "What sort of processor will be used to calculate the new variable. Functions can be taken from an installed python module `module` or a python `script` containing a function",
            "type": "string",
            "enum": [
                "module",
                "script"
            ]
        },
        "processorPath": {
            "description": "The path to the processor. When `processorType` is `module`, the name of the module - otherwise the path to the python `script` containing the function to be used, relative to the working directory",
            "type": "string"
        },
        "processorFunction": {
            "description": "The name of the function to be used to calculate the new variable",
            "type": "string"
        },
        "passXarrays": {
            "description": "Should KAPy pass xArray objects to the function? If no, then then path to the input file is passed as a string instead.",
            "type": "boolean"
        },
        "additionalArgs": {
            "description": "Additional arbitrary arguments specified as a dict to be passed to the function via keyword arguments. e.g. `{'param1':10,'doSim':true,'name':'myname'}`. Can be an empty dict if no there are no additional parameters. e.g. `{}` `",
            "type": "string"
        }
    }
}